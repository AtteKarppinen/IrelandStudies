--1.
CREATE OR REPLACE VIEW CLIENTHAS AS
(SELECT CLIENT.CLIENTID, CONCAT(' ' || CTITLE, (CONCAT(' ' || CFNAME, ' ' || CLNAME))) AS CLIENTNAME, ACCOUNT.ACCNO FROM CLIENT
LEFT JOIN HASACCOUNT ON HASACCOUNT.CLIENTID = CLIENT.CLIENTID
FULL OUTER JOIN ACCOUNT ON ACCOUNT.ACCNO = HASACCOUNT.ACCNO);

--2.
SELECT CLIENTNAME, COUNT(ACCNO) AS NUMBER_OF_ACCOUNTS FROM CLIENTHAS GROUP BY CLIENTNAME;

--3.
SELECT CLIENTNAME FROM CLIENTHAS GROUP BY CLIENTNAME HAVING COUNT(ACCNO) > 1;

--4.

